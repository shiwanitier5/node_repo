<html>
    <h1> sign in </h1>
    <head><script src="geniusmail.js"></script></head>
    <body>

        <button onclick="return myFunction()">Click me</button>



    <script>
function myFunction()
{

    chrome.identity.getAuthToken({
   interactive: true
}, function(token) {
   if (chrome.runtime.lastError) {
        alert(chrome.runtime.lastError.message);
       return;    }
     else{

      window.localStorage.setItem('access_token',token)
      //if(window.localStorage.getItem('access_token')){
      //window.location.href('https://mail.google.com/');
     // window.open('http://www.gmail.com');
      //}

      //alert(window.localStorage.getItem('access_token')
      


   }
   var x = new XMLHttpRequest();
    x.open('GET', 'https://www.googleapis.com/oauth2/v2/userinfo?alt=json&access_token=' + token);
     x.onload = function() {
       console.log(x.response);
    };
    x.send(); 
});
}



    </script>
</body>




</html>